service: flux-erp-api

provider:
  name: aws
  runtime: nodejs20.x  # âœ… UPDATED: Was nodejs18.x
  region: ap-south-2 
  memorySize: 512 
  timeout: 10 
  environment:
    NODE_ENV: production
    MONGO_URI: ${param:MONGO_URI}
    JWT_SECRET: ${param:JWT_SECRET}
    CORS_ORIGIN: 'https://flux-erp-web.vercel.app'

functions:
  api:
    handler: dist/lambda.handler 
    events:
      - http:
          path: / 
          method: ANY
          # cors: true  <-- DELETED (Lets Express handle CORS)
      - http:
          path: /{proxy+} 
          method: ANY
          # cors: true  <-- DELETED (Lets Express handle CORS)

plugins:
  - serverless-offline

package:
  individually: true
  patterns:
    - 'dist/**'           
    - 'node_modules/**'    
    - '!src/**'           
    - '!test/**'
    - '!jest.config.js'
    - '!nodemon.json'
    - '!README.md'